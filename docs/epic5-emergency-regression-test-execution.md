# Epic 5 紧急回归测试执行

**执行日期：** 2025-11-19  
**执行人：** Winston (Architect) & Amelia (DEV)  
**状态：** 🔴 进行中  
**优先级：** P0 - 紧急

---

## 📋 测试目标

验证 Epic 5 留言板功能修复后，以下核心功能是否正常工作：
1. **发布文章功能**
2. **用户退出登录功能**

---

## 🎯 第一阶段：紧急功能测试（P0）

### 测试环境
- **环境：** Vercel 生产环境
- **测试账号：** 管理员账号 + 普通用户账号
- **测试时间：** 立即开始

---

## 📊 测试用例执行

### TC-REG-1: 发布文章功能测试

#### TC-REG-1.1: 创建新文章（草稿）

**测试步骤：**
1. 登录为管理员
2. 导航到 `/admin/articles/new`
3. 填写文章表单：
   - 标题：`测试文章 - 回归测试`
   - 内容：`这是一篇测试文章，用于验证发布功能是否正常。`
   - 分类：选择任意分类（可选）
   - 标签：选择任意标签（可选）
4. 点击"保存为草稿"按钮
5. 观察页面行为

**预期结果：**
- ✅ 页面显示"文章创建成功！"消息
- ✅ 1秒后自动跳转到 `/admin/articles`
- ✅ 文章列表中显示新创建的文章，状态为"草稿"
- ✅ 无错误消息
- ✅ 浏览器控制台无错误

**实际结果：**
- [ ] 通过
- [ ] 失败（请记录错误详情）

**错误详情（如失败）：**
```
[在此记录错误消息、截图、Vercel 日志等]
```

---

#### TC-REG-1.2: 发布文章

**测试步骤：**
1. 登录为管理员
2. 导航到 `/admin/articles/new`
3. 填写文章表单：
   - 标题：`测试文章 - 发布测试`
   - 内容：`这是一篇测试文章，用于验证发布功能是否正常。`
4. 点击"发布文章"按钮
5. 观察页面行为

**预期结果：**
- ✅ 页面显示"文章创建成功！"消息
- ✅ 1秒后自动跳转到 `/admin/articles`
- ✅ 文章列表中显示新创建的文章，状态为"已发布"
- ✅ 无错误消息
- ✅ 浏览器控制台无错误

**实际结果：**
- [ ] 通过
- [ ] 失败（请记录错误详情）

**错误详情（如失败）：**
```
[在此记录错误消息、截图、Vercel 日志等]
```

---

#### TC-REG-1.3: 编辑现有文章

**测试步骤：**
1. 登录为管理员
2. 导航到 `/admin/articles`
3. 选择一篇现有文章，点击"编辑"
4. 修改文章标题或内容
5. 点击"保存更改"按钮
6. 观察页面行为

**预期结果：**
- ✅ 文章成功更新
- ✅ 页面显示成功消息
- ✅ 文章列表显示更新后的内容
- ✅ 无错误消息
- ✅ 浏览器控制台无错误

**实际结果：**
- [ ] 通过
- [ ] 失败（请记录错误详情）

**错误详情（如失败）：**
```
[在此记录错误消息、截图、Vercel 日志等]
```

---

#### TC-REG-1.4: 更新文章状态

**测试步骤：**
1. 登录为管理员
2. 导航到 `/admin/articles`
3. 选择一篇草稿文章，点击"编辑"
4. 将状态从"草稿"改为"已发布"
5. 点击"保存更改"按钮
6. 观察页面行为

**预期结果：**
- ✅ 文章状态成功更新为"已发布"
- ✅ 页面显示成功消息
- ✅ 文章列表显示更新后的状态
- ✅ 无错误消息
- ✅ 浏览器控制台无错误

**实际结果：**
- [ ] 通过
- [ ] 失败（请记录错误详情）

**错误详情（如失败）：**
```
[在此记录错误消息、截图、Vercel 日志等]
```

---

### TC-REG-2: 用户退出登录功能测试

#### TC-REG-2.1: 从个人中心页面退出

**测试步骤：**
1. 登录为任意用户（管理员或普通用户）
2. 导航到 `/profile`
3. 点击"退出登录"按钮
4. 观察页面行为

**预期结果：**
- ✅ 页面自动跳转到首页 (`/`)
- ✅ 用户会话被清除
- ✅ 导航栏显示"登录"按钮（而不是"个人中心"）
- ✅ 无错误消息
- ✅ 浏览器控制台无错误

**实际结果：**
- [ ] 通过
- [ ] 失败（请记录错误详情）

**错误详情（如失败）：**
```
[在此记录错误消息、截图、Vercel 日志等]
```

---

#### TC-REG-2.2: 从管理后台退出

**测试步骤：**
1. 登录为管理员
2. 导航到 `/admin`
3. 点击右上角"退出登录"链接
4. 观察页面行为

**预期结果：**
- ✅ 页面自动跳转到首页或登录页
- ✅ 用户会话被清除
- ✅ 无法再访问 `/admin` 页面（会被重定向）
- ✅ 无错误消息
- ✅ 浏览器控制台无错误

**实际结果：**
- [ ] 通过
- [ ] 失败（请记录错误详情）

**错误详情（如失败）：**
```
[在此记录错误消息、截图、Vercel 日志等]
```

---

#### TC-REG-2.3: 退出后会话清除验证

**测试步骤：**
1. 登录为任意用户
2. 执行退出登录操作
3. 尝试访问受保护页面：
   - `/admin`（管理员页面）
   - `/profile`（个人中心）
4. 观察页面行为

**预期结果：**
- ✅ 访问 `/admin` 时被重定向到登录页
- ✅ 访问 `/profile` 时被重定向到登录页
- ✅ 重定向 URL 包含 `callbackUrl` 参数
- ✅ 无错误消息

**实际结果：**
- [ ] 通过
- [ ] 失败（请记录错误详情）

**错误详情（如失败）：**
```
[在此记录错误消息、截图、Vercel 日志等]
```

---

## 🔍 Vercel 日志检查

### 需要检查的日志

1. **发布文章相关日志**
   - [ ] `/api/articles` POST 请求日志
   - [ ] Server Action `createArticleAction` 日志（如有）
   - [ ] 任何 401/403/500 错误

2. **退出登录相关日志**
   - [ ] `/api/auth/signout` 请求日志
   - [ ] NextAuth 相关日志
   - [ ] 任何 401/403/500 错误

### 日志检查步骤

1. 打开 Vercel Dashboard
2. 选择最新部署
3. 打开 "Functions" 标签页
4. 找到相关函数（`/api/articles`, `/api/auth/signout`）
5. 查看 "Logs" 标签页
6. 记录所有错误和警告

---

## 📊 测试结果汇总

### 测试统计

| 测试用例 | 状态 | 备注 |
|---------|------|------|
| TC-REG-1.1: 创建新文章（草稿） | ⏳ 待测试 | |
| TC-REG-1.2: 发布文章 | ⏳ 待测试 | |
| TC-REG-1.3: 编辑现有文章 | ⏳ 待测试 | |
| TC-REG-1.4: 更新文章状态 | ⏳ 待测试 | |
| TC-REG-2.1: 从个人中心退出 | ⏳ 待测试 | |
| TC-REG-2.2: 从管理后台退出 | ⏳ 待测试 | |
| TC-REG-2.3: 退出后会话清除 | ⏳ 待测试 | |

### 问题汇总

**P0 问题（阻塞性问题）：**
- [ ] 无
- [ ] 有（请列出）

**P1 问题（严重问题）：**
- [ ] 无
- [ ] 有（请列出）

**P2 问题（一般问题）：**
- [ ] 无
- [ ] 有（请列出）

---

## 🔧 问题详情（如发现问题）

### 问题 #1: [问题标题]

**严重性：** P0 / P1 / P2  
**测试用例：** TC-REG-X.X  
**问题描述：**
```
[详细描述问题]
```

**复现步骤：**
1. [步骤 1]
2. [步骤 2]
3. [步骤 3]

**错误信息：**
```
[错误消息、截图、日志等]
```

**影响范围：**
- [ ] 仅影响当前功能
- [ ] 影响多个功能
- [ ] 影响所有用户

**修复建议：**
```
[修复建议]
```

---

## ✅ 测试完成检查清单

- [ ] 所有测试用例已执行
- [ ] 所有测试结果已记录
- [ ] Vercel 日志已检查
- [ ] 问题已汇总和分类
- [ ] 测试报告已提交给 PM

---

## 📝 测试报告提交

**提交时间：** [测试完成后填写]  
**测试执行人：** Winston (Architect) & Amelia (DEV)  
**测试结果：** [通过 / 部分通过 / 失败]

**总结：**
```
[测试总结]
```

---

**最后更新：** 2025-11-19  
**状态：** 🔴 进行中

