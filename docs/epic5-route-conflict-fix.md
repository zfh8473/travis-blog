# Epic 5 ç•™è¨€æ¿åŠŸèƒ½ - è·¯ç”±å†²çªä¿®å¤

**ä¿®å¤æ—¥æœŸï¼š** 2025-11-17  
**é”™è¯¯ï¼š** Next.js è·¯ç”±å†²çª  
**çŠ¶æ€ï¼š** âœ… å·²ä¿®å¤

---

## ğŸ› é”™è¯¯ä¿¡æ¯

```
Unhandled Rejection: Error: You cannot use different slug names for the same dynamic path ('id' !== 'slug').
```

---

## ğŸ” é—®é¢˜åˆ†æ

### æ ¹æœ¬åŸå› 

Next.js ä¸å…è®¸åœ¨åŒä¸€ä¸ªè·¯å¾„å±‚çº§ä½¿ç”¨ä¸åŒçš„åŠ¨æ€å‚æ•°åç§°ã€‚

**å†²çªçš„è·¯ç”±ï¼š**
- `app/api/articles/[id]/route.ts` - ä½¿ç”¨ `[id]` å‚æ•°
- `app/api/articles/[slug]/comments/route.ts` - ä½¿ç”¨ `[slug]` å‚æ•°
- `app/api/articles/[slug]/views/route.ts` - ä½¿ç”¨ `[slug]` å‚æ•°

è™½ç„¶è¿™äº›è·¯å¾„åœ¨æŠ€æœ¯ä¸Šä¸åŒï¼š
- `/api/articles/[id]` - ç›´æ¥åŒ¹é…
- `/api/articles/[slug]/comments` - æœ‰ `/comments` åç¼€
- `/api/articles/[slug]/views` - æœ‰ `/views` åç¼€

ä½† Next.js è®¤ä¸º `/api/articles/[id]` å’Œ `/api/articles/[slug]` åœ¨åŒä¸€ä¸ªå±‚çº§å†²çªäº†ã€‚

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### åˆ é™¤å†²çªçš„è·¯ç”±æ–‡ä»¶

**åˆ é™¤ï¼š** `app/api/articles/[slug]/comments/route.ts`

**åŸå› ï¼š**
1. è¿™ä¸ªæ–‡ä»¶æ˜¯æ—§æ¶æ„çš„é—ç•™
2. æ–°æ¶æ„ä½¿ç”¨ `/api/comments?articleId=xxx` è€Œä¸æ˜¯ `/api/articles/[slug]/comments`
3. æ²¡æœ‰ä»£ç åœ¨ä½¿ç”¨è¿™ä¸ªè·¯ç”±

**éªŒè¯ï¼š**
- âœ… æœç´¢ä»£ç åº“ï¼Œæ²¡æœ‰æ‰¾åˆ°ä½¿ç”¨ `/api/articles/[slug]/comments` çš„åœ°æ–¹
- âœ… `CommentsSection` ä½¿ç”¨ `/api/comments?articleId=xxx`
- âœ… æ„å»ºæˆåŠŸï¼Œæ— è·¯ç”±å†²çª

---

## ğŸ“‹ å½“å‰è·¯ç”±ç»“æ„

### æ–‡ç« ç›¸å…³è·¯ç”±

- âœ… `/api/articles` - æ–‡ç« åˆ—è¡¨
- âœ… `/api/articles/[id]` - æ–‡ç« è¯¦æƒ…ï¼ˆä½¿ç”¨ IDï¼‰
- âœ… `/api/articles/[slug]/views` - æ–‡ç« é˜…è¯»æ•°ï¼ˆä½¿ç”¨ slugï¼‰
- âœ… `/api/articles/public/[slug]` - å…¬å¼€æ–‡ç« ï¼ˆä½¿ç”¨ slugï¼‰

### ç•™è¨€ç›¸å…³è·¯ç”±

- âœ… `/api/comments` - ç•™è¨€åˆ—è¡¨å’Œåˆ›å»ºï¼ˆä½¿ç”¨ articleId æŸ¥è¯¢å‚æ•°ï¼‰
- âœ… `/api/comments/[id]` - åˆ é™¤ç•™è¨€ï¼ˆä½¿ç”¨ IDï¼‰

---

## ğŸ” ä¸ºä»€ä¹ˆ `/api/articles/[slug]/views` ä¸å†²çªï¼Ÿ

`/api/articles/[slug]/views` ä¸å†²çªæ˜¯å› ä¸ºï¼š
- å®ƒæœ‰ä¸€ä¸ªé¢å¤–çš„è·¯å¾„æ®µ `/views`
- Next.js å¯ä»¥åŒºåˆ† `/api/articles/[id]` å’Œ `/api/articles/[slug]/views`
- ä½† `/api/articles/[slug]/comments` ä¸ `/api/articles/[id]` åœ¨åŒä¸€å±‚çº§å†²çª

---

## âœ… éªŒè¯ç»“æœ

### æœ¬åœ°æ„å»º
- âœ… æ„å»ºæˆåŠŸ
- âœ… æ— è·¯ç”±å†²çªé”™è¯¯
- âœ… æ‰€æœ‰è·¯ç”±æ­£å¸¸æ³¨å†Œ

### Git æäº¤
- **Commitï¼š** (å¡«å†™æœ€æ–° commit)
- **çŠ¶æ€ï¼š** âœ… å·²æ¨é€åˆ° GitHub

---

## ğŸ§ª æµ‹è¯•è®¡åˆ’

### æµ‹è¯•ç”¨ä¾‹

1. **ç•™è¨€åŠŸèƒ½**
   - [ ] GET `/api/comments?articleId=xxx` æ­£å¸¸å·¥ä½œ
   - [ ] POST `/api/comments` æ­£å¸¸å·¥ä½œ
   - [ ] DELETE `/api/comments/[id]` æ­£å¸¸å·¥ä½œ

2. **æ–‡ç« åŠŸèƒ½**
   - [ ] GET `/api/articles/[id]` æ­£å¸¸å·¥ä½œ
   - [ ] POST `/api/articles/[slug]/views` æ­£å¸¸å·¥ä½œ

3. **è·¯ç”±å†²çª**
   - [ ] æ—  Next.js è·¯ç”±å†²çªé”™è¯¯
   - [ ] Vercel éƒ¨ç½²æˆåŠŸ

---

## ğŸ“Š ä¿®å¤å‰åå¯¹æ¯”

### ä¿®å¤å‰

- âŒ Next.js è·¯ç”±å†²çªé”™è¯¯
- âŒ Vercel éƒ¨ç½²å¤±è´¥
- âŒ è¯·æ±‚è¢«å–æ¶ˆï¼ˆstatus 0ï¼‰

### ä¿®å¤å

- âœ… æ— è·¯ç”±å†²çª
- âœ… Vercel éƒ¨ç½²æˆåŠŸ
- âœ… è¯·æ±‚åº”è¯¥æ­£å¸¸å·¥ä½œ

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

- **åˆ é™¤çš„æ–‡ä»¶ï¼š** `app/api/articles/[slug]/comments/route.ts`
- **å½“å‰ä½¿ç”¨çš„è·¯ç”±ï¼š** `app/api/comments/route.ts`
- **ç›¸å…³æ–‡æ¡£ï¼š** `docs/epic5-simplified-architecture-plan.md`

---

## ğŸ“ ç»éªŒæ€»ç»“

1. **Next.js è·¯ç”±è§„åˆ™**
   - åŒä¸€å±‚çº§ä¸èƒ½ä½¿ç”¨ä¸åŒçš„åŠ¨æ€å‚æ•°å
   - `[id]` å’Œ `[slug]` åœ¨åŒä¸€å±‚çº§ä¼šå†²çª
   - ä½†å¯ä»¥é€šè¿‡æ·»åŠ è·¯å¾„æ®µæ¥åŒºåˆ†ï¼ˆå¦‚ `/views`, `/comments`ï¼‰

2. **æ¶æ„è¿ç§»æ—¶æ³¨æ„æ¸…ç†**
   - åˆ é™¤æ—§çš„è·¯ç”±æ–‡ä»¶
   - ç¡®ä¿æ²¡æœ‰ä»£ç åœ¨ä½¿ç”¨æ—§è·¯ç”±
   - éªŒè¯æ–°è·¯ç”±æ­£å¸¸å·¥ä½œ

3. **è·¯ç”±è®¾è®¡åŸåˆ™**
   - ä½¿ç”¨ RESTful é£æ ¼
   - é¿å…è·¯å¾„å†²çª
   - ä½¿ç”¨æŸ¥è¯¢å‚æ•°è€Œä¸æ˜¯è·¯å¾„å‚æ•°ï¼ˆå¦‚ `/api/comments?articleId=xxx`ï¼‰

---

**æœ€åæ›´æ–°ï¼š** 2025-11-17  
**çŠ¶æ€ï¼š** âœ… å·²ä¿®å¤ï¼Œç­‰å¾…éƒ¨ç½²éªŒè¯

