# Epic 5 留言板功能 - 测试清单

**测试日期：** 2025-11-17  
**测试人：** Travis + Amelia (DEV)  
**状态：** 🧪 进行中

---

## 📋 测试环境

### 本地环境
- **URL:** http://localhost:3000
- **Node.js:** (检查版本)
- **数据库:** (检查连接)

### Vercel 预览环境
- **URL:** (部署后填写)
- **部署状态:** (待部署)

---

## ✅ 阶段 1: 本地功能测试

### 1.1 留言创建（登录用户）

**测试步骤：**
1. [ ] 启动开发服务器 (`npm run dev`)
2. [ ] 访问任意文章详情页
3. [ ] 确保已登录（检查右上角用户信息）
4. [ ] 在留言表单中输入留言内容
5. [ ] 点击"提交留言"按钮
6. [ ] 验证留言立即显示在列表中
7. [ ] 验证留言显示用户名和头像（如果用户有头像）
8. [ ] 验证留言显示时间戳

**预期结果：**
- ✅ 留言成功创建
- ✅ 留言立即显示（无需刷新页面）
- ✅ 显示正确的用户信息
- ✅ 表单自动清空

**实际结果：**
- [ ] 通过
- [ ] 失败（记录错误信息）

---

### 1.2 留言创建（匿名用户）

**测试步骤：**
1. [ ] 登出（如果已登录）
2. [ ] 访问任意文章详情页
3. [ ] 验证留言表单显示"姓名"输入框
4. [ ] 输入姓名和留言内容
5. [ ] 点击"提交留言"按钮
6. [ ] 验证留言立即显示在列表中
7. [ ] 验证留言显示"访客：{姓名}"
8. [ ] 验证留言不显示头像

**预期结果：**
- ✅ 匿名用户留言成功创建
- ✅ 显示"访客："前缀
- ✅ 表单自动清空

**实际结果：**
- [ ] 通过
- [ ] 失败（记录错误信息）

---

### 1.3 留言回复

**测试步骤：**
1. [ ] 在任意留言下方点击"回复"按钮
2. [ ] 验证回复表单显示（带缩进和边框）
3. [ ] 验证显示"回复 @{用户名}"提示
4. [ ] 输入回复内容
5. [ ] 点击"提交回复"按钮
6. [ ] 验证回复显示在父留言下方（带缩进）
7. [ ] 验证回复显示正确的父留言引用

**预期结果：**
- ✅ 回复成功创建
- ✅ 回复正确嵌套显示
- ✅ 回复表单自动关闭

**实际结果：**
- [ ] 通过
- [ ] 失败（记录错误信息）

---

### 1.4 留言删除（管理员）

**测试步骤：**
1. [ ] 使用管理员账号登录
2. [ ] 访问包含留言的文章详情页
3. [ ] 验证留言显示"删除"按钮
4. [ ] 点击"删除"按钮
5. [ ] 验证确认对话框显示
6. [ ] 确认删除
7. [ ] 验证留言立即从列表中消失
8. [ ] 验证如果有回复，回复也被删除（级联删除）

**预期结果：**
- ✅ 管理员可以删除留言
- ✅ 删除确认对话框正常显示
- ✅ 留言和回复都被删除
- ✅ 列表立即更新

**实际结果：**
- [ ] 通过
- [ ] 失败（记录错误信息）

---

### 1.5 嵌套回复（3层深度）

**测试步骤：**
1. [ ] 创建顶级留言 A
2. [ ] 回复留言 A，创建回复 B（深度 1）
3. [ ] 回复回复 B，创建回复 C（深度 2）
4. [ ] 回复回复 C，创建回复 D（深度 3）
5. [ ] 尝试回复回复 D（深度 4）
6. [ ] 验证深度 4 的回复被拒绝
7. [ ] 验证显示"已达到最大回复深度"提示
8. [ ] 验证深度 1-3 的回复都正确显示（带正确的缩进）

**预期结果：**
- ✅ 可以创建最多 3 层深度的回复
- ✅ 超过 3 层的回复被拒绝
- ✅ 显示正确的错误提示
- ✅ 嵌套结构正确显示

**实际结果：**
- [ ] 通过
- [ ] 失败（记录错误信息）

---

## ✅ 阶段 2: Vercel 预览环境测试

### 2.1 部署到预览环境

**步骤：**
1. [ ] 提交代码到 GitHub
2. [ ] 推送到远程分支
3. [ ] 等待 Vercel 自动部署
4. [ ] 获取预览环境 URL
5. [ ] 验证部署成功

**部署信息：**
- **分支：** (填写)
- **Commit：** (填写)
- **预览 URL：** (填写)
- **部署时间：** (填写)

---

### 2.2 功能测试（Vercel 环境）

**测试步骤：**
1. [ ] 访问预览环境 URL
2. [ ] 验证页面正常加载（不卡住）
3. [ ] 执行所有阶段 1 的测试用例
4. [ ] 检查浏览器控制台（无 React 错误）
5. [ ] 检查网络请求（无 500 错误）
6. [ ] 验证留言功能正常工作

**预期结果：**
- ✅ 页面正常加载
- ✅ 无 React 错误 #418
- ✅ 无 500 服务器错误
- ✅ 所有功能正常

**实际结果：**
- [ ] 通过
- [ ] 失败（记录错误信息）

---

## ✅ 阶段 3: 回归测试

### 3.1 Epic 1-4, 6 功能验证

**测试范围：**
- [ ] Epic 1: 文章管理功能
- [ ] Epic 2: 用户认证功能
- [ ] Epic 3: 分类和标签功能
- [ ] Epic 4: 媒体管理功能
- [ ] Epic 6: 其他功能

**测试步骤：**
1. [ ] 验证文章列表正常显示
2. [ ] 验证文章详情页正常显示
3. [ ] 验证登录/注册功能正常
4. [ ] 验证分类和标签功能正常
5. [ ] 验证媒体上传功能正常
6. [ ] 验证其他已测试功能不受影响

**预期结果：**
- ✅ 所有已测试功能正常工作
- ✅ 无功能回归

**实际结果：**
- [ ] 通过
- [ ] 失败（记录错误信息）

---

## 📊 测试总结

### 测试结果统计

- **总测试用例：** 8
- **通过：** 0
- **失败：** 0
- **未测试：** 8

### 发现的问题

1. **问题 1：** (记录问题描述)
   - **严重程度：** (高/中/低)
   - **状态：** (待修复/已修复)

### 测试结论

- [ ] ✅ 所有测试通过，可以合并到主分支
- [ ] ⚠️ 部分测试失败，需要修复
- [ ] ❌ 测试失败，需要重新审查

---

**最后更新：** 2025-11-17  
**状态：** 🧪 测试进行中

