# Epic 3 & Epic 4 回归测试计划

**创建日期：** 2025-01-XX  
**负责人：** PM  
**状态：** 进行中  
**背景：** 编辑器从 TiptapEditor 更换为 MarkdownEditor

---

## 一、背景分析

### 1.1 变更概述

**变更内容：**
- 编辑器组件从 `TiptapEditor` 更换为 `MarkdownEditor`（@uiw/react-md-editor）
- 编辑器从富文本编辑器改为原生 Markdown 编辑器
- 数据存储格式保持不变（仍为 HTML），但编辑体验从可视化编辑改为 Markdown 源码编辑

**影响范围：**
- **Epic 3：** 文章创建、编辑功能（Story 3.2, 3.3, 3.4）
- **Epic 4：** 文章详情展示（Story 4.2）- 需要验证 HTML 渲染是否正确

### 1.2 风险评估

**高风险区域：**
1. **内容格式转换：** HTML ↔ Markdown 双向转换的准确性
2. **图片处理：** 图片上传、插入、显示是否正常
3. **现有文章兼容性：** 已存在的 HTML 文章能否正确加载和编辑
4. **内容渲染：** 前台文章详情页的 HTML 内容渲染是否正确

**中风险区域：**
1. **编辑器功能：** Markdown 语法支持、工具栏功能
2. **数据完整性：** 文章保存、更新时数据是否完整

**低风险区域：**
1. **UI/UX：** 编辑器界面和交互体验

---

## 二、测试目标

### 2.1 核心目标

1. **验证编辑器功能完整性：** 确保新编辑器满足所有原有功能需求
2. **验证数据兼容性：** 确保现有文章数据能正确加载和编辑
3. **验证内容渲染：** 确保前台文章详情页正确显示内容
4. **验证用户体验：** 确保编辑体验符合预期

### 2.2 成功标准

- ✅ 所有 Epic 3 和 Epic 4 的接受标准（AC）仍然满足
- ✅ 现有文章数据能正确加载和编辑
- ✅ 新创建的文章能正确保存和显示
- ✅ 图片上传和显示功能正常
- ✅ 前台文章详情页内容渲染正确
- ✅ 无数据丢失或格式错误

---

## 三、测试范围

### 3.1 Epic 3 测试范围

#### Story 3.2: 编辑器集成（**重点测试**）
- [ ] Markdown 编辑器正常加载
- [ ] Markdown 语法输入正常（## 标题、**粗体**、*斜体*等）
- [ ] 工具栏功能正常
- [ ] 实时预览功能正常
- [ ] 图片拖拽上传功能
- [ ] 图片粘贴上传功能
- [ ] 图片在编辑器中正确显示
- [ ] HTML 到 Markdown 转换准确性
- [ ] Markdown 到 HTML 转换准确性

#### Story 3.3: 文章创建功能（**重点测试**）
- [ ] 文章创建页面正常加载
- [ ] 标题输入和验证
- [ ] 内容编辑器正常使用
- [ ] 摘要输入
- [ ] 分类选择
- [ ] 标签添加和移除
- [ ] 草稿保存功能
- [ ] 发布功能
- [ ] 表单验证
- [ ] 错误处理
- [ ] 成功后的重定向

#### Story 3.4: 文章编辑功能（**重点测试**）
- [ ] 文章编辑页面正常加载
- [ ] 现有文章内容正确预填充到编辑器
- [ ] HTML 内容正确转换为 Markdown 显示
- [ ] 编辑后保存功能正常
- [ ] 更新后内容正确保存
- [ ] 分类和标签更新正常
- [ ] 状态更新正常（草稿/发布）

#### Story 3.5: 文章删除功能
- [ ] 删除功能不受影响（不涉及编辑器）

#### Story 3.6: 文章分类管理
- [ ] 分类选择功能正常
- [ ] 分类显示正常（不涉及编辑器）

#### Story 3.7: 文章标签管理
- [ ] 标签添加功能正常
- [ ] 标签显示正常（不涉及编辑器）

### 3.2 Epic 4 测试范围

#### Story 4.1: 文章列表页面
- [ ] 文章列表正常显示（不涉及编辑器）

#### Story 4.2: 文章详情页面（**重点测试**）
- [ ] 文章详情页正常加载
- [ ] HTML 内容正确渲染
- [ ] 图片正确显示
- [ ] 格式正确显示（标题、段落、列表、链接等）
- [ ] Markdown 转换后的 HTML 渲染正确
- [ ] 响应式布局正常

#### Story 4.3: 分类筛选功能
- [ ] 分类筛选正常（不涉及编辑器）

#### Story 4.4: 标签筛选功能
- [ ] 标签筛选正常（不涉及编辑器）

#### Story 4.5: 分页功能
- [ ] 分页功能正常（不涉及编辑器）

---

## 四、测试计划

### 4.1 测试阶段

#### 阶段 1：功能验证测试（优先级：高）
**目标：** 验证核心功能是否正常工作  
**时间：** 2-3 小时  
**负责人：** Dev + QA

**测试内容：**
1. 新文章创建流程（完整端到端测试）
2. 现有文章编辑流程（完整端到端测试）
3. 图片上传功能（拖拽、粘贴）
4. 内容格式验证（Markdown 语法、HTML 渲染）

#### 阶段 2：兼容性测试（优先级：高）
**目标：** 验证现有数据兼容性  
**时间：** 1-2 小时  
**负责人：** Dev + QA

**测试内容：**
1. 加载现有文章（各种格式的 HTML 内容）
2. 编辑现有文章并保存
3. 验证数据完整性（无丢失、无格式错误）

#### 阶段 3：用户体验测试（优先级：中）
**目标：** 验证编辑体验  
**时间：** 1 小时  
**负责人：** UX Designer + PM

**测试内容：**
1. Markdown 编辑体验
2. 工具栏使用体验
3. 预览功能体验
4. 图片上传体验

#### 阶段 4：回归测试（优先级：高）
**目标：** 验证所有相关功能  
**时间：** 2-3 小时  
**负责人：** QA

**测试内容：**
1. 执行所有 Epic 3 和 Epic 4 的接受标准测试
2. 验证边界情况
3. 验证错误处理

### 4.2 测试用例清单

#### 测试用例组 1：编辑器基础功能

**TC-1.1: Markdown 编辑器加载**
- **前置条件：** 管理员已登录
- **步骤：**
  1. 导航到 `/admin/articles/new`
  2. 观察编辑器是否正常加载
- **预期结果：** 编辑器正常显示，无错误

**TC-1.2: Markdown 语法输入**
- **前置条件：** 在文章创建页面
- **步骤：**
  1. 在编辑器中输入 `## 标题`
  2. 输入 `**粗体文本**`
  3. 输入 `*斜体文本*`
  4. 输入列表、链接等语法
- **预期结果：** 所有语法正常输入，无字符被删除或光标跳转

**TC-1.3: HTML 内容加载**
- **前置条件：** 存在一篇包含 HTML 格式的文章
- **步骤：**
  1. 导航到文章编辑页面
  2. 观察编辑器内容
- **预期结果：** HTML 内容正确转换为 Markdown 并显示

**TC-1.4: Markdown 内容保存**
- **前置条件：** 在文章创建页面，已输入 Markdown 内容
- **步骤：**
  1. 点击"保存为草稿"
  2. 检查数据库中的内容
- **预期结果：** Markdown 正确转换为 HTML 并保存

#### 测试用例组 2：图片上传功能

**TC-2.1: 图片拖拽上传**
- **前置条件：** 在文章创建页面
- **步骤：**
  1. 从文件管理器拖拽图片到编辑器
  2. 观察上传过程
  3. 检查图片是否插入到编辑器
- **预期结果：** 图片成功上传并插入为 Markdown 图片语法

**TC-2.2: 图片粘贴上传**
- **前置条件：** 在文章创建页面，剪贴板中有图片
- **步骤：**
  1. 在编辑器中粘贴图片
  2. 观察上传过程
  3. 检查图片是否插入
- **预期结果：** 图片成功上传并插入

**TC-2.3: 图片显示验证**
- **前置条件：** 文章已保存并包含图片
- **步骤：**
  1. 查看文章详情页
  2. 检查图片是否正常显示
- **预期结果：** 图片在详情页正确显示

#### 测试用例组 3：内容渲染验证

**TC-3.1: HTML 内容渲染**
- **前置条件：** 文章已发布，包含各种格式（标题、段落、列表、链接、图片）
- **步骤：**
  1. 访问文章详情页
  2. 检查内容渲染
- **预期结果：** 所有格式正确渲染

**TC-3.2: Markdown 转换后的 HTML 渲染**
- **前置条件：** 使用新编辑器创建的文章已发布
- **步骤：**
  1. 访问文章详情页
  2. 检查内容渲染
- **预期结果：** 内容正确渲染，格式正确

#### 测试用例组 4：数据兼容性

**TC-4.1: 现有文章加载**
- **前置条件：** 存在多篇不同格式的现有文章
- **步骤：**
  1. 逐一打开文章编辑页面
  2. 检查内容是否正确加载
- **预期结果：** 所有文章内容正确加载和显示

**TC-4.2: 现有文章编辑保存**
- **前置条件：** 打开现有文章编辑页面
- **步骤：**
  1. 修改内容
  2. 保存文章
  3. 检查保存后的内容
- **预期结果：** 内容正确保存，无数据丢失

---

## 五、人员分工

### 5.1 测试团队

**Dev（开发人员）：**
- 负责：功能验证测试、兼容性测试
- 任务：
  - 执行 TC-1.x, TC-2.x, TC-4.x 测试用例
  - 修复发现的 bug
  - 验证技术实现

**QA（测试人员）：**
- 负责：回归测试、测试用例执行
- 任务：
  - 执行所有测试用例
  - 记录测试结果
  - 编写测试报告

**UX Designer（用户体验设计师）：**
- 负责：用户体验测试
- 任务：
  - 执行 TC-1.2（Markdown 编辑体验）
  - 评估编辑体验
  - 提供改进建议

**PM（产品经理）：**
- 负责：测试计划制定、进度跟踪、结果评估
- 任务：
  - 协调测试进度
  - 评估测试结果
  - 决定是否通过测试

### 5.2 时间安排

**Day 1（今天）：**
- 上午：Dev 执行功能验证测试（阶段 1）
- 下午：Dev + QA 执行兼容性测试（阶段 2）

**Day 2：**
- 上午：UX Designer 执行用户体验测试（阶段 3）
- 下午：QA 执行回归测试（阶段 4）

**Day 3：**
- 上午：修复发现的问题
- 下午：复测和最终验证

---

## 六、测试环境

### 6.1 测试环境要求

- **环境：** Vercel 生产环境（部署后）
- **数据库：** 生产数据库（建议使用测试数据）
- **浏览器：** Chrome、Safari、Firefox（最新版本）
- **设备：** 桌面端、平板、移动端

### 6.2 测试数据准备

- **现有文章：** 准备 5-10 篇不同格式的测试文章
  - 包含纯文本
  - 包含格式化文本（标题、列表、链接）
  - 包含图片
  - 包含复杂 HTML 结构

---

## 七、问题跟踪

### 7.1 问题分类

**P0 - 阻塞性问题：**
- 编辑器无法加载
- 无法保存文章
- 数据丢失

**P1 - 严重问题：**
- 图片上传失败
- 内容格式错误
- 现有文章无法加载

**P2 - 一般问题：**
- UI 显示问题
- 用户体验问题

### 7.2 问题记录模板

```markdown
**问题 ID：** BUG-XXX
**优先级：** P0/P1/P2
**发现人：** [姓名]
**发现时间：** [日期时间]
**问题描述：** [详细描述]
**复现步骤：** [步骤列表]
**预期结果：** [预期行为]
**实际结果：** [实际行为]
**截图/日志：** [附件]
**状态：** 待修复/修复中/已修复/已验证
```

---

## 八、测试报告

### 8.1 测试报告模板

测试完成后，需要生成测试报告，包含：

1. **测试执行摘要**
   - 测试用例总数
   - 通过数量
   - 失败数量
   - 通过率

2. **问题汇总**
   - 问题列表
   - 优先级分布
   - 修复状态

3. **风险评估**
   - 剩余风险
   - 建议措施

4. **结论**
   - 是否通过测试
   - 是否可以发布

---

## 九、后续行动

### 9.1 测试通过后

- 更新文档（Epic 3 Story 3.2 更新为 MarkdownEditor）
- 更新测试用例
- 更新用户文档（如有）

### 9.2 测试未通过

- 修复所有 P0 和 P1 问题
- 重新执行测试
- 评估是否需要回滚

---

## 十、附录

### 10.1 相关文档

- Epic 3 文档：`docs/epics/epic-3-内容创作和管理content-creation-management.md`
- Epic 4 文档：`docs/epics/epic-4-内容展示content-display.md`
- 编辑器组件：`components/editor/MarkdownEditor.tsx`
- 文章创建页面：`app/admin/articles/new/page.tsx`
- 文章编辑页面：`app/admin/articles/[id]/edit/page.tsx`
- 文章详情页面：`app/articles/[slug]/page.tsx`

### 10.2 测试检查清单

**Epic 3 检查清单：**
- [ ] Story 3.2: 编辑器集成 - 所有 AC 满足
- [ ] Story 3.3: 文章创建功能 - 所有 AC 满足
- [ ] Story 3.4: 文章编辑功能 - 所有 AC 满足
- [ ] Story 3.5: 文章删除功能 - 所有 AC 满足
- [ ] Story 3.6: 文章分类管理 - 所有 AC 满足
- [ ] Story 3.7: 文章标签管理 - 所有 AC 满足

**Epic 4 检查清单：**
- [ ] Story 4.1: 文章列表页面 - 所有 AC 满足
- [ ] Story 4.2: 文章详情页面 - 所有 AC 满足
- [ ] Story 4.3: 分类筛选功能 - 所有 AC 满足
- [ ] Story 4.4: 标签筛选功能 - 所有 AC 满足
- [ ] Story 4.5: 分页功能 - 所有 AC 满足

---

**文档状态：** 待执行  
**最后更新：** 2025-01-XX  
**下次审查：** 测试完成后

